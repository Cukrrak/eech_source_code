// 
// 	 Enemy Engaged RAH-66 Comanche Versus KA-52 Hokum
// 	 Copyright (C) 2000 Empire Interactive (Europe) Ltd,
// 	 677 High Road, North Finchley, London N12 0DA
// 
// 	 Please see the document LICENSE.TXT for the full licence agreement
// 
// 2. LICENCE
//  2.1 	
//  	Subject to the provisions of this Agreement we now grant to you the 
//  	following rights in respect of the Source Code:
//   2.1.1 
//   	the non-exclusive right to Exploit  the Source Code and Executable 
//   	Code on any medium; and 
//   2.1.2 
//   	the non-exclusive right to create and distribute Derivative Works.
//  2.2 	
//  	Subject to the provisions of this Agreement we now grant you the
// 	following rights in respect of the Object Code:
//   2.2.1 
// 	the non-exclusive right to Exploit the Object Code on the same
// 	terms and conditions set out in clause 3, provided that any
// 	distribution is done so on the terms of this Agreement and is
// 	accompanied by the Source Code and Executable Code (as
// 	applicable).
// 
// 3. GENERAL OBLIGATIONS
//  3.1 
//  	In consideration of the licence granted in clause 2.1 you now agree:
//   3.1.1 
// 	that when you distribute the Source Code or Executable Code or
// 	any Derivative Works to Recipients you will also include the
// 	terms of this Agreement;
//   3.1.2 
// 	that when you make the Source Code, Executable Code or any
// 	Derivative Works ("Materials") available to download, you will
// 	ensure that Recipients must accept the terms of this Agreement
// 	before being allowed to download such Materials;
//   3.1.3 
// 	that by Exploiting the Source Code or Executable Code you may
// 	not impose any further restrictions on a Recipient's subsequent
// 	Exploitation of the Source Code or Executable Code other than
// 	those contained in the terms and conditions of this Agreement;
//   3.1.4 
// 	not (and not to allow any third party) to profit or make any
// 	charge for the Source Code, or Executable Code, any
// 	Exploitation of the Source Code or Executable Code, or for any
// 	Derivative Works;
//   3.1.5 
// 	not to place any restrictions on the operability of the Source 
// 	Code;
//   3.1.6 
// 	to attach prominent notices to any Derivative Works stating
// 	that you have changed the Source Code or Executable Code and to
// 	include the details anddate of such change; and
//   3.1.7 
//   	not to Exploit the Source Code or Executable Code otherwise than
// 	as expressly permitted by  this Agreement.
// 



/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "project.h"

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#define LIEUTENANT_POINTS_BASE		0
#define CAPTAIN_POINTS_BASE			7500
#define MAJOR_POINTS_BASE				32000
#define LT_COLONEL_POINTS_BASE		120000
#define COLONEL_POINTS_BASE			250000

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static player_log_type
	*player_log_list,
	*current_player_log;

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

unsigned char
	*pilot_rank_names [] =
	{
		"RANK_NAME_NONE",	
		"LIEUTENANT",
		"CAPTAIN",
		"MAJOR",
		"LT_COLONEL",
		"COLONEL",
		"NUM_PILOT_RANKS"
	};

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

unsigned char
	*medal_type_names [] =
	{
		"MEDAL_NONE",
		"SAUDI",
		"LEBANON",
		"TAIWAN",
		"ARMY_AVIATOR",
		"SENIOR_AVIATOR",
		"MASTER_AVIATOR",
		"PURPLE_HEART",
		"AIR_MEDAL",
		"FLYING_CROSS",
		"SILVER_STAR",
		"DISTINGUISHED_SERVICE",
		"MEDAL_OF_HONOUR",
		"NUM_MEDAL_TYPES"
	};

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void inc_player_log_air_kills (int side, player_log_type *log);
static void inc_player_log_ground_kills (int side, player_log_type *log);
static void inc_player_log_sea_kills (int side, player_log_type *log);
static void inc_player_log_fixed_kills (int side, player_log_type *log);
static void inc_player_log_friendly_kills (int side, player_log_type *log);
static void inc_player_log_deaths (int side, player_log_type *log);

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void initialise_medal_and_promotion_names (void)
{

	us_medal_type_names [MEDAL_TYPE_NONE] = NULL;
	us_medal_type_names [MEDAL_SAUDI] = "Medal Saudi";
	us_medal_type_names [MEDAL_LEBANON] = "Medal Lebanon";
	us_medal_type_names [MEDAL_TAIWAN] = "Medal Taiwan";
	us_medal_type_names [MEDAL_ARMY_AVIATOR] = "Medal Army Wings";
	us_medal_type_names [MEDAL_SENIOR_AVIATOR] = "Medal Senior Wings";
	us_medal_type_names [MEDAL_MASTER_AVIATOR] = "Medal Master Wings";
	us_medal_type_names [MEDAL_PURPLE_HEART] = "Medal Purple";
	us_medal_type_names [MEDAL_AIR_MEDAL] = "Medal Air";
	us_medal_type_names [MEDAL_FLYING_CROSS] = "Medal Distinguished";
	us_medal_type_names [MEDAL_SILVER_STAR] = "Medal Silver";
	us_medal_type_names [MEDAL_DISTINGUISHED_SERVICE] = "Medal Service";
	us_medal_type_names [MEDAL_MEDAL_OF_HONOUR] = "Medal Honour";

	cis_medal_type_names [MEDAL_TYPE_NONE] = NULL;
	cis_medal_type_names [MEDAL_SAUDI] = "Medal SV Yemen";
	cis_medal_type_names [MEDAL_LEBANON] = "Medal SV Lebanon";
	cis_medal_type_names [MEDAL_TAIWAN] = "Medal SV Taiwan";
	cis_medal_type_names [MEDAL_ARMY_AVIATOR] = "Medal SV Army Wings";
	cis_medal_type_names [MEDAL_SENIOR_AVIATOR] = "Medal SV Senior Wings";
	cis_medal_type_names [MEDAL_MASTER_AVIATOR] = "Medal SV Master Wings";
	cis_medal_type_names [MEDAL_PURPLE_HEART] = "Medal SV Glory";
	cis_medal_type_names [MEDAL_AIR_MEDAL] = "Medal SV Banner";
	cis_medal_type_names [MEDAL_FLYING_CROSS] = "Medal SV Lenin";
	cis_medal_type_names [MEDAL_SILVER_STAR] = "Medal SV Service";
	cis_medal_type_names [MEDAL_DISTINGUISHED_SERVICE] = "Medal SV Victory";
	cis_medal_type_names [MEDAL_MEDAL_OF_HONOUR] = "Medal SV Star";

	rank_type_names [PILOT_RANK_NONE] = NULL;
	rank_type_names [PILOT_RANK_LIEUTENANT] = "Lieutenant";
	rank_type_names [PILOT_RANK_CAPTAIN] = "Captain";
	rank_type_names [PILOT_RANK_MAJOR] = "Major";
	rank_type_names [PILOT_RANK_LT_COLONEL] = "Lt. Colonel";
	rank_type_names [PILOT_RANK_COLONEL] = "Colonel";
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

unsigned char *get_pilot_rank_name (int rank)
{
	ASSERT ((rank > PILOT_RANK_NONE) && (rank < NUM_PILOT_RANKS));

	switch ( rank )
	{

		case PILOT_RANK_LIEUTENANT:
		{

			return (get_trans ("Lieutenant"));

			break;
		}

		case PILOT_RANK_CAPTAIN:
		{

			return (get_trans ("Captain"));

			break;
		}

		case PILOT_RANK_MAJOR:
		{

			return (get_trans ("Major"));

			break;
		}

		case PILOT_RANK_LT_COLONEL:
		{

			return (get_trans ("Lt. Colonel"));

			break;
		}

		case PILOT_RANK_COLONEL:
		{

			return (get_trans ("Colonel"));

			break;
		}
	}

	return ( NULL );
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

unsigned char *get_pilot_rank_short_name (int rank)
{
	ASSERT ((rank > PILOT_RANK_NONE) && (rank < NUM_PILOT_RANKS));

	switch ( rank )
	{

		case PILOT_RANK_LIEUTENANT:
		{

			return (get_trans ("Lt."));

			break;
		}

		case PILOT_RANK_CAPTAIN:
		{

			return (get_trans ("Capt."));

			break;
		}

		case PILOT_RANK_MAJOR:
		{

			return (get_trans ("Maj."));

			break;
		}

		case PILOT_RANK_LT_COLONEL:
		{

			return (get_trans ("Lt. Col."));

			break;
		}

		case PILOT_RANK_COLONEL:
		{

			return (get_trans ("Col."));

			break;
		}
	}

	return ( NULL );
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

unsigned char *get_untranslated_pilot_rank_short_name (int rank)
{
	ASSERT ((rank > PILOT_RANK_NONE) && (rank < NUM_PILOT_RANKS));

	switch ( rank )
	{
		case PILOT_RANK_LIEUTENANT:
		{
			return ("Lt.");
		}

		case PILOT_RANK_CAPTAIN:
		{
			return ("Capt.");
		}

		case PILOT_RANK_MAJOR:
		{
			return ("Maj.");
		}

		case PILOT_RANK_LT_COLONEL:
		{
			return ("Lt. Col.");
		}

		case PILOT_RANK_COLONEL:
		{
			return ("Col.");
		}
	}

	return ( NULL );
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

player_log_type *get_player_log_list ()
{
	return player_log_list;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_log_list (player_log_type *log)
{
	player_log_list = log;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

player_log_type *get_current_player_log ()
{
	return current_player_log;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_current_player_log (player_log_type *log)
{
	current_player_log = log;

	// debug
	unregister_file_tag_variable ("TRAINING1_LEVEL");
	unregister_file_tag_variable ("TRAINING2_LEVEL");
	unregister_file_tag_variable ("TRAINING3_LEVEL");
	unregister_file_tag_variable ("TRAINING4_LEVEL");
	unregister_file_tag_variable ("TRAINING5_LEVEL");

	register_file_tag_variable ("TRAINING1_LEVEL", &log->side_log [ENTITY_SIDE_BLUE_FORCE].level [0]);
	register_file_tag_variable ("TRAINING2_LEVEL", &log->side_log [ENTITY_SIDE_BLUE_FORCE].level [1]);
	register_file_tag_variable ("TRAINING3_LEVEL", &log->side_log [ENTITY_SIDE_BLUE_FORCE].level [2]);
	register_file_tag_variable ("TRAINING4_LEVEL", &log->side_log [ENTITY_SIDE_BLUE_FORCE].level [3]);
	register_file_tag_variable ("TRAINING5_LEVEL", &log->side_log [ENTITY_SIDE_BLUE_FORCE].level [4]);
	// end
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

player_log_type *get_player_log_next (player_log_type *log)
{
	ASSERT (log);
	
	return log->next;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

unsigned char *get_player_log_name (player_log_type *log)
{
	ASSERT (log);

	return log->name;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_rank_from_points ( int points )
{

	if ( points < CAPTAIN_POINTS_BASE )
	{
		return ( PILOT_RANK_LIEUTENANT );
	}
	else if ( points < MAJOR_POINTS_BASE )
	{
		return ( PILOT_RANK_CAPTAIN );
	}
	else if ( points < LT_COLONEL_POINTS_BASE )
	{
		return ( PILOT_RANK_MAJOR );
	}
	else if ( points < COLONEL_POINTS_BASE )
	{
		return ( PILOT_RANK_LT_COLONEL );
	}
	else
	{
		return ( PILOT_RANK_COLONEL );
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_points_from_rank ( int rank )
{

	switch ( rank )
	{

		case PILOT_RANK_LIEUTENANT:
		{

			return ( LIEUTENANT_POINTS_BASE );

			break;
		}

		case PILOT_RANK_CAPTAIN:
		{

			return ( CAPTAIN_POINTS_BASE );

			break;
		}

		case PILOT_RANK_MAJOR:
		{

			return ( MAJOR_POINTS_BASE );

			break;
		}

		case PILOT_RANK_LT_COLONEL:
		{

			return ( LT_COLONEL_POINTS_BASE );

			break;
		}

		case PILOT_RANK_COLONEL:
		{

			return ( COLONEL_POINTS_BASE );

			break;
		}

		default:
		{

			return ( LIEUTENANT_POINTS_BASE );
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_log_rank (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].rank;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_log_rank (int side, player_log_type *log, int rank)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].rank = rank;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_log_experience (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].experience;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_log_experience (int side, player_log_type *log, int experience)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	if ( experience < 0 )
	{

		experience = 0;
	}

	log->side_log [side].experience = experience;

	debug_log ("PLAYER: --------------------------------------------------------------------------------");
	debug_log ("PLAYER: current %d", log->side_log [side].experience);
	debug_log ("PLAYER:    lieutenant	%d", LIEUTENANT_POINTS_BASE);
	debug_log ("PLAYER:    captain 		%d", CAPTAIN_POINTS_BASE);
	debug_log ("PLAYER:    major			%d", MAJOR_POINTS_BASE);
	debug_log ("PLAYER:    Lt Colonel	%d", LT_COLONEL_POINTS_BASE);
	debug_log ("PLAYER:    Colonel		%d", COLONEL_POINTS_BASE);
	debug_log ("PLAYER: --------------------------------------------------------------------------------");
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_experience (int side, player_log_type *log, int delta_experience)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].experience += delta_experience;

	debug_log ("PLAYER: --------------------------------------------------------------------------------");
	debug_log ("PLAYER: %d points awarded, current %d", delta_experience, log->side_log [side].experience);
	debug_log ("PLAYER:    lieutenant	%d", LIEUTENANT_POINTS_BASE);
	debug_log ("PLAYER:    captain 		%d", CAPTAIN_POINTS_BASE);
	debug_log ("PLAYER:    major			%d", MAJOR_POINTS_BASE);
	debug_log ("PLAYER:    Lt Colonel	%d", LT_COLONEL_POINTS_BASE);
	debug_log ("PLAYER:    Colonel		%d", COLONEL_POINTS_BASE);
	debug_log ("PLAYER: --------------------------------------------------------------------------------");
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_log_missions_flown (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].missions_flown;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_log_missions_flown (int side, player_log_type *log, int missions_flown)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].missions_flown = missions_flown;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_missions_flown (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].missions_flown += 1;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_log_failed_tours (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].failed_tours;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_log_failed_tours (int side, player_log_type *log, int failed_tours)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].failed_tours = failed_tours;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_failed_tours (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].failed_tours += 1;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_log_successful_tours (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].successful_tours;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_log_successful_tours (int side, player_log_type *log, int successful_tours)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].successful_tours = successful_tours;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_successful_tours (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].successful_tours += 1;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_log_level (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].level [0];
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_log_level (int side, player_log_type *log, int level)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].level [0] = level;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

float get_player_log_flying_hours (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return (float) log->side_log [side].flying_seconds / TIME_1_HOUR;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

float get_player_log_flying_seconds (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].flying_seconds;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_log_flying_seconds (int side, player_log_type *log, float flying_seconds)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].flying_seconds = flying_seconds;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_flying_seconds (int side, player_log_type *log, float delta_flying_seconds)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].flying_seconds += delta_flying_seconds;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_air_kills (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].kills.air ++;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_ground_kills (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].kills.ground ++;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_sea_kills (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].kills.sea ++;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_fixed_kills (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].kills.fixed ++;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_friendly_kills (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].kills.friendly ++;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_deaths (int side, player_log_type *log)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].kills.deaths ++;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_log_kills (int side, player_log_type *log, entity *victim)
{
	ASSERT (victim);

	if (victim == get_gunship_entity ())
	{
		inc_player_log_deaths (side, log);
	}
	else
	{
		if (get_local_entity_int_value (victim, INT_TYPE_SIDE) != get_global_gunship_side ())
		{
			switch (get_local_entity_type (victim))
			{
				case ENTITY_TYPE_FIXED_WING:
				case ENTITY_TYPE_HELICOPTER:
				{
					inc_player_log_air_kills (side, log);
		
					break;
				}
				case ENTITY_TYPE_ANTI_AIRCRAFT:
				case ENTITY_TYPE_ROUTED_VEHICLE:
				{
					inc_player_log_ground_kills (side, log);
		
					break;
				}
				case ENTITY_TYPE_SHIP_VEHICLE:
				{
					inc_player_log_sea_kills (side, log);
		
					break;
				}
				case ENTITY_TYPE_BRIDGE:
				case ENTITY_TYPE_CITY_BUILDING:
				case ENTITY_TYPE_SCENIC:
				case ENTITY_TYPE_SITE:
				case ENTITY_TYPE_SITE_UPDATABLE:
				{
					inc_player_log_fixed_kills (side, log);
		
					break;
				}
				default:
				{
					break;
				}
			}
		}
		else
		{
			inc_player_log_friendly_kills (side, log);
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void update_player_log_mission_success_rate (int side, player_log_type *log, float success_rate)
{
	int
		missions_flown;

	float
		total_success_rate;

	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	missions_flown = log->side_log [side].missions_flown;

	total_success_rate =	(float)missions_flown * log->side_log [side].mission_success_rate;

	total_success_rate += success_rate;

	missions_flown += 1;

	log->side_log [side].mission_success_rate = (total_success_rate / missions_flown);

	log->side_log [side].missions_flown = missions_flown;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_log_task_level (int side, player_log_type *log)
{

	int
		rank;

	rank = get_player_log_rank (side, log);

	switch ( rank )
	{

		case PILOT_RANK_LIEUTENANT:
		{

			return ( 6 );

			break;
		}

		case PILOT_RANK_CAPTAIN:
		{

			return ( 7 );

			break;
		}

		case PILOT_RANK_MAJOR:
		{

			return ( 8 );

			break;
		}

		case PILOT_RANK_LT_COLONEL:
		{

			return ( 9 );

			break;
		}

		case PILOT_RANK_COLONEL:
		{

			return ( 10 );

			break;
		}
	}

	return ( 0 );
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_weapon_log_fired (int side, player_log_type *log, int weapon)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].weapon_usage[weapon][WEAPON_LOG_FIRED];
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_weapon_log_fired (int side, player_log_type *log, int weapon, int fired_count)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].weapon_usage[weapon][WEAPON_LOG_FIRED] =  fired_count;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_weapon_log_fired (int side, player_log_type *log, int weapon)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	++log->side_log [side].weapon_usage[weapon][WEAPON_LOG_FIRED];
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int get_player_weapon_log_hit (int side, player_log_type *log, int weapon)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	return log->side_log [side].weapon_usage[weapon][WEAPON_LOG_FIRED];
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_player_weapon_log_hit (int side, player_log_type *log, int weapon, int hit_count)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	log->side_log [side].weapon_usage[weapon][WEAPON_LOG_HIT] =  hit_count;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void inc_player_weapon_log_hit (int side, player_log_type *log, int weapon)
{
	ASSERT (log);

	ASSERT ((side >= 0) && (side <= NUM_ENTITY_SIDES));

	++log->side_log [side].weapon_usage[weapon][WEAPON_LOG_HIT];
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


